import{l as i,m as F,v as A,o as D,c as H,x as E,j as p,f as s,w as U,u as e,A as g,H as Y,a as Z,a0 as ee,a7 as se,k as oe,s as ae,a9 as M,a8 as ne,ae as te,q as le,b as re,B as ce,F as ie,af as ue,ag as de,p as pe,i as me,aa as ve,ab as C,ac as N,ad as fe,ah as _e}from"./entry.195bb4e7.js";import{g as q,a as we,l as ge,s as ke,b as $e}from"./seoConfig.5451a65f.js";const Pe=s("img",{src:Y,alt:"close"},null,-1),be=[Pe],he=s("div",{class:"wrapper-text"},[s("p",null,"После удаления вы не сможете восстановить данный аккаунт"),s("p",null,"Вы уверены, что хотите удалить аккаунт?")],-1),ye={class:"wrapper-button"},Be={__name:"AcceptDialog",emits:["closeAcceptDialog"],setup(k,{emit:V}){let m=i(!0);F(()=>{document.addEventListener("click",h)});function h(f){Array.from(f.target.classList).includes("v-overlay__scrim")&&v()}function v(f){removeEventListener("click",h),V("closeAcceptDialog",f)}return(f,t)=>{const y=A("v-card"),_=A("v-dialog");return D(),H(_,{class:"dialog accept-dialog",modelValue:e(m),"onUpdate:modelValue":t[3]||(t[3]=u=>g(m)?m.value=u:m=u),width:"400",persistent:""},{default:E(()=>[p(y,{class:"card"},{default:E(()=>[s("button",{class:"close-button",onClick:t[0]||(t[0]=U(u=>v(!1),["prevent"]))},be),he,s("section",ye,[s("button",{class:"reject",onClick:t[1]||(t[1]=u=>v(!1))},"Нет"),s("button",{class:"secondary accept",onClick:t[2]||(t[2]=u=>v(!0))},"Да")])]),_:1})]),_:1},8,["modelValue"])}}};const b=k=>(pe("data-v-1c60dbf8"),k=k(),me(),k),xe={class:"wrapper-settings",id:"settings"},Ce={class:"settings"},Ve=b(()=>s("div",{class:"title"},[s("h1",null,"Настройки"),s("span",null,"Здесь вы можете управлять данными своей учетной записи.")],-1)),Ie={class:"account"},Se=b(()=>s("h3",null,"Аккаунт",-1)),Ae={class:"wrapper-account-button"},De=["onClick"],Ue={class:"change-password"},Le=b(()=>s("h3",null,"Сменить пароль",-1)),Re={class:"wrapper-account-button"},je=["onClick"],Oe=b(()=>s("h3",null,"Удалить свой аккаунт",-1)),Ee=b(()=>s("span",null,"Удалив свою учетную запись, вы не сможете создавать новые изображения, ваши краски будут потеряны, а все данные, связанные с вашей учетной записью, будут безвозвратно утеряны. Это действие необратимо! ",-1)),Me={__name:"settings",setup(k){const{setProperty:V}=$e();V(q.title,[...we,...q.meta],ge,ke);const{getPersonInfo:m}=ee(),{deleteAccount:h,updatePassword:v,updateUserData:f}=se(),{mapErrors:t}=ve(),y=oe(),{person:_}=ae(y),{changePerson:u}=y,{personMapper:T}=_e(),w=i({name:""}),B=M({name:{required:C}},w),l=i({oldPassword:"",newPassword:"",confirmation:""}),z=ne(()=>l.value.newPassword),G={oldPassword:{required:C,minLength:N(6)},newPassword:{required:C,minLength:N(6)},confirmation:{required:C,sameAs:fe(z)}},r=M(G,l),{prepareLogout:L}=te();let d=i(!1),n=i(!1),I=i(!1),$=i(!1),R=i(""),P=i(!1),j=i("");F(()=>{m(),w.value.name=_.value.name}),le(_,o=>{w.value.name=o.name});async function J(){B.value.$error||await f(w.value.name,_.value.email).then(o=>{o.status==="success"&&(u(T(o.user,_.value.token)),O(o.message))}).catch(o=>{o.status==="error"?console.log(o):o.statusCode===401&&L()})}async function K(){r.value.$validate(),r.value.$error?S("Данные заполнены не корректно"):await v(l.value.newPassword,l.value.confirmation,l.value.oldPassword).then(o=>{o.status==="success"&&(O(o.message),l.value={oldPassword:"",newPassword:"",confirmation:""},r.value.$reset())}).catch(o=>{o.status===400?S(o.data.message):o.status===401?L():S("Что-то пошло не так")})}function O(o){R.value=o,$.value=!0}function S(o){j.value=o,P.value=!0}function Q(){I.value=!0}function W(o){I.value=!1,X(o)}function X(o){o&&h()}return(o,a)=>{const x=A("v-text-field");return D(),re(ie,null,[s("div",xe,[s("section",Ce,[Ve,s("div",Ie,[Se,s("form",null,[p(x,{modelValue:w.value.name,"onUpdate:modelValue":a[0]||(a[0]=c=>w.value.name=c),label:"Имя","error-messages":e(t)(e(B).name.$errors),onInput:e(B).name.$touch,onBlur:e(B).name.$touch},null,8,["modelValue","error-messages","onInput","onBlur"]),s("div",Ae,[s("button",{class:"secondary no-hover",onClick:U(J,["prevent"])},"Обновить данные",8,De)])])]),s("div",Ue,[Le,p(x,{modelValue:l.value.oldPassword,"onUpdate:modelValue":a[1]||(a[1]=c=>l.value.oldPassword=c),label:"Старый пароль","error-messages":e(t)(e(r).oldPassword.$errors),"append-inner-icon":e(d)?"mdi-eye":"mdi-eye-off",type:e(d)?"text":"password","onClick:appendInner":a[2]||(a[2]=c=>g(d)?d.value=!e(d):d=!e(d)),onInput:e(r).oldPassword.$touch,onBlur:e(r).oldPassword.$touch},null,8,["modelValue","error-messages","append-inner-icon","type","onInput","onBlur"]),p(x,{modelValue:l.value.newPassword,"onUpdate:modelValue":a[3]||(a[3]=c=>l.value.newPassword=c),label:"Новый пароль","error-messages":e(t)(e(r).newPassword.$errors),"append-inner-icon":e(n)?"mdi-eye":"mdi-eye-off",type:e(n)?"text":"password","onClick:appendInner":a[4]||(a[4]=c=>g(n)?n.value=!e(n):n=!e(n)),onInput:e(r).newPassword.$touch,onBlur:e(r).newPassword.$touch},null,8,["modelValue","error-messages","append-inner-icon","type","onInput","onBlur"]),p(x,{modelValue:l.value.confirmation,"onUpdate:modelValue":a[5]||(a[5]=c=>l.value.confirmation=c),label:"Повторите новый пароль","error-messages":e(t)(e(r).confirmation.$errors),"append-inner-icon":e(n)?"mdi-eye":"mdi-eye-off",type:e(n)?"text":"password","onClick:appendInner":a[6]||(a[6]=c=>g(n)?n.value=!e(n):n=!e(n)),onInput:e(r).confirmation.$touch,onBlur:e(r).confirmation.$touch},null,8,["modelValue","error-messages","append-inner-icon","type","onInput","onBlur"]),s("div",Re,[s("button",{class:"secondary no-hover",onClick:U(K,["prevent"])},"Обновить пароль",8,je)])]),s("div",{class:"delete-account"},[Oe,Ee,s("div",{class:"button-delete-account"},[s("button",{onClick:Q},"Удалить аккаунт...")])])])]),e(I)?(D(),H(e(Be),{key:0,onCloseAcceptDialog:W})):ce("",!0),p(e(ue),{openSnackBar:e($),"text-snack-bar":e(R),onClose:a[7]||(a[7]=c=>g($)?$.value=!1:$=!1)},null,8,["openSnackBar","text-snack-bar"]),p(e(de),{openSnackBar:e(P),"text-snack-bar":e(j),onClose:a[8]||(a[8]=c=>g(P)?P.value=!1:P=!1)},null,8,["openSnackBar","text-snack-bar"])],64)}}},He=Z(Me,[["__scopeId","data-v-1c60dbf8"]]);export{He as default};

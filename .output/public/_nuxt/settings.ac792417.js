import{l as i,m as q,v as I,o as S,c as F,x as O,j as p,f as o,w as A,u as e,A as w,H as Y,a as Z,a1 as ee,a8 as se,k as oe,s as ae,aa as E,a9 as te,af as ne,q as le,b as re,B as ce,F as ie,ag as ue,ah as de,p as pe,i as me,ab as ve,ac as x,ad as M,ae as fe,ai as _e}from"./entry.85e81008.js";import{s as we}from"./seo.b312e431.js";import{c as N,a as ge,l as ke,s as $e}from"./seoConfig.16f52c3c.js";const Pe=o("img",{src:Y,alt:"close"},null,-1),he=[Pe],ye=o("div",{class:"wrapper-text"},[o("p",null,"После удаления вы не сможете восстановить данный аккаунт"),o("p",null,"Вы уверены, что хотите удалить аккаунт?")],-1),Be={class:"wrapper-button"},be={__name:"AcceptDialog",emits:["closeAcceptDialog"],setup(g,{emit:C}){let m=i(!0);q(()=>{document.addEventListener("click",h)});function h(f){Array.from(f.target.classList).includes("v-overlay__scrim")&&v()}function v(f){removeEventListener("click",h),C("closeAcceptDialog",f)}return(f,l)=>{const y=I("v-card"),_=I("v-dialog");return S(),F(_,{class:"dialog accept-dialog",modelValue:e(m),"onUpdate:modelValue":l[3]||(l[3]=u=>w(m)?m.value=u:m=u),width:"400",persistent:""},{default:O(()=>[p(y,{class:"card"},{default:O(()=>[o("button",{class:"close-button",onClick:l[0]||(l[0]=A(u=>v(!1),["prevent"]))},he),ye,o("section",Be,[o("button",{class:"reject",onClick:l[1]||(l[1]=u=>v(!1))},"Нет"),o("button",{class:"secondary accept",onClick:l[2]||(l[2]=u=>v(!0))},"Да")])]),_:1})]),_:1},8,["modelValue"])}}};const P=g=>(pe("data-v-6852e486"),g=g(),me(),g),xe={class:"wrapper-settings",id:"settings"},Ce={class:"settings"},Ve=P(()=>o("div",{class:"title"},[o("h1",null,"Настройки"),o("span",null,"Здесь вы можете управлять данными своей учетной записи.")],-1)),Ie={class:"account"},Se=P(()=>o("h3",null,"Аккаунт",-1)),Ae={class:"wrapper-account-button"},De=["onClick"],Ue={class:"change-password"},Le=P(()=>o("h3",null,"Сменить пароль",-1)),Re={class:"wrapper-account-button"},je=["onClick"],Oe=P(()=>o("h3",null,"Удалить свой аккаунт",-1)),Ee=P(()=>o("span",null,"Удалив свою учетную запись, вы не сможете создавать новые изображения, ваши краски будут потеряны, а все данные, связанные с вашей учетной записью, будут безвозвратно утеряны. Это действие необратимо! ",-1)),Me={__name:"settings",setup(g){const{setProperty:C}=we();C(N.title,[...ge,...N.meta],ke,$e);const{getPersonInfo:m}=ee(),{deleteAccount:h,updatePassword:v,updateUserData:f}=se(),{mapErrors:l}=ve(),y=oe(),{person:_}=ae(y),{changePerson:u}=y,{personMapper:H}=_e(),t=i({name:""}),B=E({name:{required:x}},t),T=i({oldPassword:"",newPassword:"",confirmation:""}),z=te(()=>t.value.newPassword),G={oldPassword:{required:x,minLength:M(6)},newPassword:{required:x,minLength:M(6)},confirmation:{required:x,sameAs:fe(z)}},r=E(G,T),{prepareLogout:D}=ne();let d=i(!1),n=i(!1),V=i(!1),k=i(!1),U=i(""),$=i(!1),L=i("");q(()=>{m(),t.value.name=_.value.name}),le(_,s=>{t.value.name=s.name});async function J(){B.value.$error||await f(t.value.name,_.value.email).then(s=>{s.status==="success"&&(u(H(s.user,_.value.token)),R(s.message))}).catch(s=>{s.status==="error"?console.log(s):s.statusCode===401&&D()})}async function K(){r.value.$validate(),r.value.$error?j("Данные заполнены не корректно"):await v(t.value.newPassword,t.value.confirmation,t.value.oldPassword).then(s=>{s.status==="success"&&(R(s.message),t.value={oldPassword:"",newPassword:"",confirmation:""},r.value.$reset())}).catch(s=>{s.status===400?j(s.data.message):s.status===401?D():s.status==="error"&&console.log(s.status)})}function R(s){U.value=s,k.value=!0}function j(s){L.value=s,$.value=!0}function Q(){V.value=!0}function W(s){V.value=!1,X(s)}function X(s){s&&h()}return(s,a)=>{const b=I("v-text-field");return S(),re(ie,null,[o("div",xe,[o("section",Ce,[Ve,o("div",Ie,[Se,o("form",null,[p(b,{modelValue:t.value.name,"onUpdate:modelValue":a[0]||(a[0]=c=>t.value.name=c),label:"Имя","error-messages":e(l)(e(B).name.$errors),onInput:e(B).name.$touch,onBlur:e(B).name.$touch},null,8,["modelValue","error-messages","onInput","onBlur"]),o("div",Ae,[o("button",{class:"secondary no-hover",onClick:A(J,["prevent"])},"Обновить данные",8,De)])])]),o("div",Ue,[Le,p(b,{modelValue:t.value.oldPassword,"onUpdate:modelValue":a[1]||(a[1]=c=>t.value.oldPassword=c),label:"Старый пароль","error-messages":e(l)(e(r).oldPassword.$errors),"append-inner-icon":e(d)?"mdi-eye":"mdi-eye-off",type:e(d)?"text":"password","onClick:appendInner":a[2]||(a[2]=c=>w(d)?d.value=!e(d):d=!e(d)),onInput:e(r).oldPassword.$touch,onBlur:e(r).oldPassword.$touch},null,8,["modelValue","error-messages","append-inner-icon","type","onInput","onBlur"]),p(b,{modelValue:t.value.newPassword,"onUpdate:modelValue":a[3]||(a[3]=c=>t.value.newPassword=c),label:"Новый пароль","error-messages":e(l)(e(r).newPassword.$errors),"append-inner-icon":e(n)?"mdi-eye":"mdi-eye-off",type:e(n)?"text":"password","onClick:appendInner":a[4]||(a[4]=c=>w(n)?n.value=!e(n):n=!e(n)),onInput:e(r).newPassword.$touch,onBlur:e(r).newPassword.$touch},null,8,["modelValue","error-messages","append-inner-icon","type","onInput","onBlur"]),p(b,{modelValue:t.value.confirmation,"onUpdate:modelValue":a[5]||(a[5]=c=>t.value.confirmation=c),label:"Повторите новый пароль","error-messages":e(l)(e(r).confirmation.$errors),"append-inner-icon":e(n)?"mdi-eye":"mdi-eye-off",type:e(n)?"text":"password","onClick:appendInner":a[6]||(a[6]=c=>w(n)?n.value=!e(n):n=!e(n)),onInput:e(r).confirmation.$touch,onBlur:e(r).confirmation.$touch},null,8,["modelValue","error-messages","append-inner-icon","type","onInput","onBlur"]),o("div",Re,[o("button",{class:"secondary no-hover",onClick:A(K,["prevent"])},"Обновить пароль",8,je)])]),o("div",{class:"delete-account"},[Oe,Ee,o("div",{class:"button-delete-account"},[o("button",{onClick:Q},"Удалить аккаунт...")])])])]),e(V)?(S(),F(e(be),{key:0,onCloseAcceptDialog:W})):ce("",!0),p(e(ue),{openSnackBar:e(k),"text-snack-bar":e(U),onClose:a[7]||(a[7]=c=>w(k)?k.value=!1:k=!1)},null,8,["openSnackBar","text-snack-bar"]),p(e(de),{openSnackBar:e($),"text-snack-bar":e(L),onClose:a[8]||(a[8]=c=>w($)?$.value=!1:$=!1)},null,8,["openSnackBar","text-snack-bar"])],64)}}},Te=Z(Me,[["__scopeId","data-v-6852e486"]]);export{Te as default};
